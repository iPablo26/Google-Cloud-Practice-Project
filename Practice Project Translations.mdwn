# First LAB: VPC Networking

## Objectives: 

In this lab, you learn how to perform the following tasks:

    - Explore the default VPC network
    
    - Create an auto mode network with firewall rules
    
    - Convert an auto mode network to a custom mode network
    
    - Create custom mode VPC networks with firewall rules
    
    - Create VM instances using Compute Engine
    
    - Explore the connectivity for VM instances across VPC networks

## Steps:

1. Explore the default network:
   
     # View the subnets
     gcloud compute networks subnets list

    # View the routes
     gcloud compute routes list 

     # View the firewall rules
     gcloud compute firewall-rules list

    # Delete the Firewall rules
     gcloud compute firewall-rules delete 'default-allow-icmp'

    # Delete the default network
     gcloud compute networks delete default

    # Try to create a VM instance (will fail)
     gcloud compute instances create pablo-2682 --subnet=default


2. Create an auto mode network:

    # Create an auto mode VPC network with firewall rules
    gcloud compute networks create mynetwork --subnet-mode=auto

    # Create a VM instance in us-central1
    gcloud compute firewall-rules create mynetwork --direction=INGRESS --priority=65534 --network=mynetwork --action=ALLOW --rules=all --source-ranges=0.0.0.0/0

    # Create a VM instance in europe-west1
    gcloud compute instances create mynet-us-vm --zone=us-central1-c --machine-type=n1-standard-1 --subnet=mynetwork

    # Verify connectivity for the VM instances
    gcloud compute instances create mynet-eu-vm --zone=europe-west1-c --machine-type=n1-standard-1 --subnet=mynetwork

    # For mynet-us-vm, click SSH to launch a terminal and connect
    ping -c 3 10.132.0.2

    # Repeat the same test by running the following
    ping -c 3 mynet-eu-vm

    # To test connectivity to mynet-eu-vm's external IP
    ping -c 3 <Enter mynet-eu-vm's external IP here>

    # Convert the network to a custom mode network
    gcloud compute networks update mynetwork --switch-to-custom-subnet-mode

3. Create custom mode networks:

    # Create the managementnet network
    gcloud compute networks create managementnet --subnet-mode=custom

    # To create the managementsubnet-us subnet, run the following command:
    gcloud compute networks subnets create managementsubnet-us --range=10.130.0.0/20 --network=managementnet --region=us-central1

    # Create the privatenet network
    gcloud compute networks create privatenet --subnet-mode=custom
     
    # To create the privatesubnet-us subnet, run the following command:
    gcloud compute networks subnets create privatesubnet-us --network=privatenet --region=us-central1 --range=172.16.0.0/24

    # To create the privatesubnet-eu subnet, run the following command:
    gcloud compute networks subnets create privatesubnet-eu --network=privatenet --region=europe-west1 --range=172.20.0.0/20

    # To list the available VPC networks, run the following command:
    gcloud compute networks list

    # To list the available VPC subnets (sorted by VPC network), run the following command:
    gcloud compute networks subnets list --sort-by=NETWORK

    # Create the firewall rules for managementnet
    gcloud compute firewall-rules create managementnet-allow-icmp-ssh-rdp --direction=INGRESS --priority=1000 --network=managementnet --action=ALLOW --rules=tcp:22,tcp:3389,icmp --source-ranges=0.0.0.0/0

    # Create the firewall rules for privatenet
    gcloud compute firewall-rules create privatenet-allow-icmp-ssh-rdp --direction=INGRESS --priority=1000 --network=privatenet --action=ALLOW --rules=icmp,tcp:22,tcp:3389 --source-ranges=0.0.0.0/0

    # To list all the firewall rules (sorted by VPC network), run the following command:
    gcloud compute firewall-rules list --sort-by=NETWORK

    # Create the managementnet-us-vm instance
    gcloud compute instances create managementnet-us-vm --zone=us-central1-c --machine-type=f1-micro --subnet=managementsubnet-us

    # Create the privatenet-us-vm instance
    gcloud compute instances create privatenet-us-vm --zone=us-central1-c --machine-type=f1-micro --subnet=privatesubnet-us

    # To list all the VM instances (sorted by zone), run the following command
    gcloud compute instances list --sort-by=ZONE

4. Explore the connectivity across networks

    # Ping the external IP addresses
    For mynet-us-vm, click SSH to launch a terminal and connect

    # To test connectivity to mynet-eu-vm's external IP, run the following command
    ping -c 3 <Enter mynet-eu-vm's external IP here>

    # To test connectivity to managementnet-us-vm's external IP, run the following
    ping -c 3 <Enter managementnet-us-vm's external IP here>

    # To test connectivity to privatenet-us-vm's external IP, run the following command
    ping -c 3 <Enter privatenet-us-vm's external IP here>

    # Return to the SSH terminal for mynet-us-vm: To test connectivity to mynet-eu-vm's internal IP, run the following command
    ping -c 3 <Enter mynet-eu-vm's internal IP here>

    # To test connectivity to managementnet-us-vm's internal IP, run the following
    ping -c 3 <Enter managementnet-us-vm's internal IP here>

    # To test connectivity to privatenet-us-vm's internal IP, run the following command
    ping -c 3 <Enter privatenet-us-vm's internal IP here>



    # Second LAB: Implement Private Google Access and Cloud NAT

## Objectives: 